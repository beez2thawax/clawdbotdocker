services:
  clawdbot:
    build: .
    restart: unless-stopped
    expose:
      - 18789
    labels:
      - traefik.enable=true
      - traefik.http.routers.clawdbot.rule=Host(`${FQDN}`)
      - traefik.http.routers.clawdbot.entrypoints=http,https
      - traefik.http.services.clawdbot.loadbalancer.server.port=18789
      - traefik.http.routers.clawdbot.tls=true
      - traefik.http.routers.clawdbot.tls.certresolver=letsencrypt
    environment:
      NODE_ENV: production
      ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY}
      TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN:-}
      GATEWAY_TOKEN: ${GATEWAY_TOKEN:-please-change-this-token}
    volumes:
      - clawdbot-data:/root/.clawdbot
      - workspace-data:/app/workspace

volumes:
  clawdbot-data:
  workspace-data:
